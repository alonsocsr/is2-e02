{% extends "base.html" %}

{% load static %}
{% block title %}
    House Stark Blog | Landing
{% endblock title %}

{% block content %}
<div class="pt-10 p-10 m-5 flex flex-col lg:flex-row items-center justify-between gap-12">
    
    <!-- Componente animado (lado izquierdo) -->
    <section id="dynamic-text" class="lg:w-1/2 w-full flex items-center justify-center">
        <div class="text-center space-y-12">
            <div class="text-center text-5xl font-bold ">
                <span style="font-family: 'Roboto', sans-serif;">The North Remembers</span>
                <div class="relative inline-grid grid-cols-1 grid-rows-1 gap-12 overflow-hidden">
                    <span class="animate-word col-span-full row-span-full" style="font-family: 'Playfair Display', serif;">Stories</span>
                    <span class="animate-word-delay-1 col-span-full row-span-full" style="font-family: 'Playfair Display', serif;">Voices</span>
                    <span class="animate-word-delay-2 col-span-full row-span-full" style="font-family: 'Playfair Display', serif;">Opinions</span>
                    <span class="animate-word-delay-3 col-span-full row-span-full" style="font-family: 'Playfair Display', serif;">Debates</span>
                    <span class="animate-word-delay-4 col-span-full row-span-full" style="font-family: 'Playfair Display', serif;">Connections</span>
                </div>
            </div>
            <p class="text-gray-600 text-sm">
                Stark es el lugar donde las ideas se encuentran. Lee los mejores contenidos, participa en los debates y comparte tus pensamientos.            </p>
        </div>
    </section>

    <!-- Carrusel  -->
    <section id="carousel-posts" class="lg:w-1/2 w-full mt-10 lg:mt-0">
        <div class="gallery border-2 rounded-xl mx-auto m-5 bg-white shadow-lg" style="width:750px;">
            <!-- título del contenido -->
            <div class="top flex p-2 border-b select-none rounded-t-xl bg-gray-100">
                <div class="heading text-gray-800 w-full pl-3 font-semibold my-auto"></div>
                <div class="buttons ml-auto flex text-gray-600 mr-1">
                    <!--  anterior -->
                    <svg action="prev" class="w-7 border-2 rounded-l-lg p-1 cursor-pointer border-r-0 hover:bg-gray-200"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path action="prev" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    <!--  siguiente -->
                    <svg action="next" class="w-7 border-2 rounded-r-lg p-1 cursor-pointer hover:bg-gray-200"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path action="next" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M14 5l7 7m0 0l-7 7m7-7H3" />
                    </svg>
                </div>
            </div>
            <!-- contenido -->
            <div class="content-area w-full h-96 overflow-hidden rounded-b-xl">
                <div class="platform shadow-xl h-full flex">
                    
                    {% for contenido in contenidos %}
                    <div class="each-frame border-box flex-none h-full" title="{{ contenido.titulo }}">
                        <a href="{% url 'detalle_contenido' contenido.id %}" class="block w-full h-full hover:bg-gray-100 rounded-xl duration-300">

                            <div class="main flex w-full p-8">
                                <!-- Imagen  -->
                                <div class="sub w-4/6 my-auto">
                                    <img class="w-full h-48 object-cover rounded-lg" src="{% if contenido.imagen %}{{ contenido.imagen.url }}{% else %}/static/default.jpg{% endif %}" alt="{{ contenido.titulo }}">
                                </div>
                                <!-- Información -->
                                <div class="sub w-full my-auto px-4">
                                    <!-- Autor y categoría -->
                                    <div class="text-sm mb-4 flex items-center space-x-4">
                                        <img class="w-8 h-8 rounded-full" src="{% if contenido.autor.profile.image %}{{ contenido.autor.profile.image.url }}{% else %}/static/default.png{% endif %}" alt="{{ contenido.autor.username }}">
                                        <div>
                                            <span class="font-semibold">{{ contenido.autor.username }}</span>
                                            <br>
                                            <span class="text-gray-600">{{ contenido.categoria.nombre_categoria }}</span>
                                        </div>
                                    </div>
                                    <!-- Título  -->
                                    <div class="head text-3xl font-bold mb-2">{{ contenido.titulo }}</div>
                                    <!-- Resumen  -->
                                    <div class="long-text text-lg text-gray-700">{{ contenido.resumen|truncatewords:20 }}</div>
                                    <!-- Fecha -->
                                    <div class="text-sm mt-4 text-gray-600">{{ contenido.fecha_creacion|date:"d M Y" }}</div>
                                </div>
                            </div>
                        </a>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Sección de últimos posts -->
<section id="latest-posts" class="mt-12 p-6">
    <h2 class="text-3xl font-bold text-gray-800 text-center mb-8">Latest Posts</h2>

    <div class="flex justify-center gap-y-8 lg:gap-y-0 flex-wrap md:flex-wrap lg:flex-nowrap lg:flex-row lg:justify-between lg:gap-x-8">
        {% for contenido in contenidos %}
            <!-- Estilo de los posts -->
            {% include "includes/contenido.html" %}
        {% empty %}
            <p class="text-gray-600">No hay posts disponibles.</p>
        {% endfor %}
    </div>

</section>

<style>
  .platform {
    position: relative;
    transition: right 0.3s;
  }

    .gallery {
        border-radius: 1rem;
    }

    .platform .each-frame {
        border-radius: 1rem;
    }

  .body {
    background-color: white !important;
  }

  @keyframes word {
    0% {
        transform: translateY(100%);
    }
    15% {
        transform: translateY(-10%);
        animation-timing-function: ease-out;
    }

    20% {
        transform: translateY(0);
    }

    40%,
    100% {
        transform: translateY(-110%);
    }
    }

    .animate-word {
    animation: word 7s infinite;
    }
    .animate-word-delay-1 {
    animation: word 7s infinite;
    animation-delay: -1.4s;
    }
    .animate-word-delay-2 {
    animation: word 7s infinite;
    animation-delay: -2.8s;
    }
    .animate-word-delay-3 {
    animation: word 7s infinite;
    animation-delay: -4.2s;
    }
    .animate-word-delay-4 {
    animation: word 7s infinite;
    animation-delay: -5.6s;
    }
</style>
<script>
    function gallery() {
        this.index = 0;
        this.load = function () {
            this.rootEl = document.querySelector(".gallery");
            this.platform = this.rootEl.querySelector(".platform");
            this.frames = this.platform.querySelectorAll(".each-frame");
            this.contentArea = this.rootEl.querySelector(".content-area");
            this.width = parseInt(this.rootEl.style.width);
            this.limit = { start: 0, end: this.frames.length - 1 };
            this.frames.forEach(each => { each.style.width = this.width + "px"; });
            this.goto(this.index);
        }
        this.set_title = function () {
            this.rootEl.querySelector(".heading").innerText = this.frames[this.index].getAttribute("title");
        }
        this.next = function () { this.platform.style.right = this.width * ++this.index + "px"; this.set_title(); }
        this.prev = function () { this.platform.style.right = this.width * --this.index + "px"; this.set_title(); }
        this.goto = function (index) { this.platform.style.right = this.width * index + "px"; this.index = index; this.set_title(); }
        this.load();
    }
    var G = new gallery();
    G.rootEl.addEventListener("click", function (t) {
        var val = t.target.getAttribute("action");
        if (val == "next" && G.index != G.limit.end) { G.next(); }
        if (val == "prev" && G.index != G.limit.start) { G.prev(); }
        if (val == "goto") {
            let rv = t.target.getAttribute("goto");
            rv = rv == "end" ? G.limit.end : rv;
            G.goto(parseInt(rv));
        }
    });
    document.addEventListener("keyup", function (t) {
        var val = t.keyCode;
        if (val == 39 && G.index != G.limit.end) { G.next(); }
        if (val == 37 && G.index != G.limit.start) { G.prev(); }
    });
</script>

{% endblock content %}
